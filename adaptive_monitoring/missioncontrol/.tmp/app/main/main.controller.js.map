{"version":3,"sources":["../../../client/app/main/main.controller.js"],"names":[],"mappings":"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","file":"main.controller.js","sourcesContent":["'use strict';\n(function() {\n\nfunction MainController($scope, $http, $interval) {\n\n  this.commands = [];\n  this.failedCommands = [];\n  this.pendingCommands = [];\n\n  this.locations = [];\n  this.tracedLocs = [];\n  this.satLoc = {};\n\n  this.polyline = {\n      stroke: {\n          color: '#F00',\n          weight: 3,\n          opacity: 0.4\n      },\n      stroke2: {\n        color: '#F00',\n        weight: 3,\n        opacity: 1.0\n      }\n  };\n\n  $scope.self = this;\n\n  this.satMarker = {\n    idKey: 0,\n    options: {\n      icon: {\n        anchor: {x: 15, y: 15},\n        url: 'assets/images/sat_icon.png'\n      },\n      visible: false\n    }\n  };\n\n  this.map = {\n      center: {\n          latitude: 0,\n          longitude: 0\n      },\n      zoom: 2,\n      options: {\n          mapTypeId: 'satellite',\n          mapTypeControl: false,\n          streetViewControl: false,\n          rotateControl: false,\n          panControl: false,\n          overviewMapControl: false,\n          scaleControl: false,\n          zoomControl: false,\n          scrollwheel: false,\n          styles: [\n          {\n              elementType: 'labels',\n              featureType: 'all',\n              stylers: [ { visibility: 'off' } ]\n          }\n          ]\n      }\n  };\n\n  var changedPromise;\n\n  this.satChanged = function() {\n    this.refreshLocations();\n    if(changedPromise != undefined) {\n      $interval.cancel(changedPromise);\n    }\n    changedPromise = $interval(this.refreshLocation, 30000, 0, true, this.selectedSatellite);\n    this.satMarker.options.visible = true;\n  };\n\n  // this.availableSatellites = [\n  //   {\n  //     _id: '1',\n  //     name: 'LAICE'\n  //   },\n  //   {\n  //     _id: '2',\n  //     name: 'ION'\n  //   }\n  // ];\n\n  $http.get('/api/satellites')\n  .then((response) => {\n    console.log(response);\n    this.availableSatellites = response.data;\n  });\n\n\n  $http.get('/api/commands')\n  .then((response) => {\n    console.log(response);\n    this.commands = response.data;\n    this.failedCommands = _(this.commands).filter((command) => command.status === 'failed').value();\n    this.pendingCommands = _(this.commands).filter((command) => command.status === 'pending').value();\n    this.nextTenCommands = _(this.commands).filter((command) => command.status === 'pending').take(10).value();\n  });\n\n  this.refreshLocation = function(sat) {\n    $http.get(`/api/satellites/${sat}/location`)\n    .then(response => {\n      let loc = response.data;\n      $scope.self.tracedLocs.push(loc);\n      $scope.self.satLoc = loc;\n      console.log('Updated satellite position.');\n    });\n    $http.get(`/api/satellites/${sat}/futureLocation?interval=120`)\n    .then(response => {\n      let loc = response.data;\n      $scope.self.locations.push(loc);\n      console.log(\"Updated orbit trace.\");\n    });\n  }\n\n  this.refreshLocations = function() {\n    $http.get(`/api/satellites/${this.selectedSatellite}/locations?interval=120`)\n    .then(response => {\n        let locs = response.data;\n        let locations = _.map(locs, function(point) {\n            return { latitude: point.latitude, longitude: point.longitude };\n        });\n\n        this.locations = locations;\n        this.tracedLocs = [];\n        this.tracedLocs.push(locations[0]);\n        this.satLoc = locations[0];\n        console.log(this.locations);\n    });\n  };\n}\n\nangular.module('missioncontrolApp')\n  .controller('MainController', MainController);\n\n})();\n"]}